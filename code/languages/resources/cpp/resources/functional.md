# Functors

> **–§—É–Ω–∫—Ç–æ—Ä—ã** –∏–ª–∏ **—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã**, —Ç.–µ. —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä(), —Ç.–µ. —Ç–∞–∫–æ–π –æ–±—ä–µ–∫—Ç —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç ‚Äú—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ‚Äù.
> 

```cpp
class SimpleFunctor {
    std::string name_;
public:
    SimpleFunctor(const char *name) : name_(name) {}
    void operator()() 
			{ std::cout << "Oh, hello, " << name_ << endl; }
};

int main() {
    SimpleFunctor sf("catonmat");
    sf();  // –≤—ã–≤–æ–¥–∏—Ç "Oh, hello, catonmat"
}
```

<aside>
üí° –ß–∞—â–µ –≤—Å–µ–≥–æ —Ñ—É–Ω–∫—Ç–æ—Ä—ã –≤ –°++ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–µ–¥–∏–∫–∞—Ç–æ–≤, –ø—Å–µ–≤–¥–æ–∑–∞–º—ã–∫–∞–Ω–∏–π –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–π —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö STL. –ß–µ—Å—Ç–Ω–æ –≥–æ–≤–æ—Ä—è, —ç—Ç–æ –∏–∑–¥–µ—Ä–∂–∫–∏ –æ–±—ã—á–Ω–æ–π –ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∏–ª–∏ –Ω–∞–∑–≤–∞—Ç—å –∫–∞–∫-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ‚Ä¶

</aside>

# Callback-—Ñ—É–Ω–∫—Ü–∏–∏

> **Callback** - –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ù–∞–ø–æ–º–Ω—é, —á—Ç–æ —Å–∞–º–æ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è —Å—Å—ã–ª–∫–æ–π –Ω–∞ –Ω–∞—á–∞–ª–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –æ–¥–Ω–∞–∫–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –°++ –º–æ–∂–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å—Å—è –∫ —É–∫–∞–∑–∞—Ç–µ–ª—é.
> 

```cpp
std::string dataFromBd(){
    return "Data from BD";
}

std::string dataFromMe(){
    return "Data from Me";
}

std::string dataFromServer(){
    return "Data from Server";
}

// callBack –∏–º—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–µ–±–µ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏.
void showMsg(std::string (*callBack)()) 
{
    cout << callBack();
}

int main()
{
    showMsg(dataFromMe); // –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ª–∏—Å—Ç —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã

		// –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –ø—Ä–æ callBack
		void(*callBackHolder)() = dataDromBd
		cout << callBackHolder();
    return 0;
}
```

üí° –ü–µ—Ä–µ–º–µ–Ω–Ω—É—é, —Ö—Ä–∞–Ω—è—â—É—é —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤–æ—Ç —Ç–∞–∫:
`int (*) (int, int)` ‚Üí –≥–¥–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ —Ç–∞–∫ ‚Üí int **sum**(int, int)
–¢–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–∞ –∑–∞–ø–∏—Å—å —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞: `int(int,int)`, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ —Ä–∞–≤–Ω–æ—Å–∏–ª—å–Ω–æ —Å–ª—É—á–∞—é –≤—ã—à–µ‚Ä¶
–ö—É–¥–∞ —É–¥–æ–±–Ω–µ–µ –≤—Å—ë —ç—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∏ –æ–±—ë—Ä—Ç—ã–≤–∞—Ç—å –≤ std::function<int(int,int)> sum. –¢–∞–∫–æ–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Å –°++11 –≤ header‚Äô–µ

```cpp
//...
// callBack –∏–º—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å–µ–±–µ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å std::string –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–∞ –≤—Ö–æ–¥
void showMsg(std::function<std::string ()> callBack)
{
    cout << callBack();
}
//..
```

# Lambdas

> –ì—Ä—É–±–æ –≥–æ–≤–æ—Ä—è, —ç—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ–º–æ–µ —Ç–µ–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –∫—É–¥–∞ —É–≥–æ–¥–Ω–æ –≤ –∫–æ–¥–µ, —Ö–æ—Ç—å –≤ —Å–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –∫—É–¥–∞-–ª–∏–±–æ –µ—â—ë. –ù–æ —Å—Ç–æ–∏—Ç –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –ª—è–º–±–¥–∞ - —Ç–æ–∂–µ, –≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è, –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–∏–ø. –¢–∞–∫ –∂–µ –∫–∞–∂–¥–∞—è –Ω–∞–ø–∏—Å–∞–Ω–Ω–∞—è –ª—è–º–±–¥–∞ - *—É–Ω–∏–∫–∞–ª—å–Ω–∞*, —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–Ω–∞—Ç—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –ø—ã—Ç–∞—Ç—å—Å—è –¥–µ–ª–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–∏—Å—Ç—ã –ª—è–º–±–¥.
> 

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –ª—è–º–±–¥–∞ –ø–æ–Ω—è—Ç–∏—è –Ω–µ –∏–º–µ–µ—Ç, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞ –µ—ë –ø—Ä–µ–¥–µ–ª–∞–º–∏, –¥–ª—è —ç—Ç–æ–≥–æ –Ω–∞–¥–æ –µ–π —É–∫–∞–∑—ã–≤–∞—Ç—å, —á—Ç–æ –º–æ–∂–Ω–æ "–∑–∞—Ö–≤–∞—Ç–∏—Ç—å", —á—Ç–æ–±—ã –ª—è–º–±–¥–∞ –≤–∏–¥–µ–ª–∞ —ç—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Å–≤–æ–µ–≥–æ –±–ª–æ–∫–∞ –∫–æ–¥–∞ {}. –õ—è–º–±–¥–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å [], –æ–±—â–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:  

- [] - —ç—Ç–æ –æ–±–ª–∞—Å—Ç—å –∑–∞—Ö–≤–∞—Ç–∞, –º–æ–∂–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ [x,y] –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é (–µ—Å–ª–∏ –≤ —Ç–µ–ª–µ –ª—è–º–±–¥—ã –º–µ–Ω—è—Ç—å —Ç–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, —Ç–æ –≤–æ –≤–Ω–µ –æ–Ω–∏ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—Å—è), –∞ –º–æ–∂–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –ø–æ —Å—Å—ã–ª–∫–µ [&x, &y] (–æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —Ç–∞–∫ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–∏–º–∏ –≤ —Ç–µ–ª–µ –ª—è–º–±–¥—ã –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ –≤–Ω–µ —É–∂–µ –∏–∑–º–µ–Ω—è—Ç—Å—è)
- () - —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–∏ –Ω–∏—Ö –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –ø–æ —Ç–∏–ø—É mutable
- ->Type - —É–∫–∞–∑–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –ª—è–º–±–¥–∞ –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å‚Ä¶ –º–æ–∂–Ω–æ –Ω–µ –ø–∏—Å–∞—Ç—å, –µ—Å–ª–∏ —Å–ª—É—á–∞–π –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ—Ä–Ω—É—Ç—å 5, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –ø–æ–π–º—ë—Ç, —á—Ç–æ —Ä–µ—á—å –∏–¥—ë—Ç –ø—Ä–æ int).
- {} - –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ª—è–º–±–¥—ã

<aside>
üí° [=] –∏ [&] –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –≤–Ω–µ—à–Ω–µ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é –∏ –ø–æ —Å—Å—ã–ª–∫–∞–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–æ —Ç–∞–∫–æ–µ –¥–µ–ª–∞—Ç—å –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
[this] –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –∫–ª–∞—Å—Å –ø–æ —Å—Å—ã–ª–∫–µ, –≤–ø–æ–ª–Ω–µ –Ω–æ—Ä–º

</aside>

<aside>
üí° –õ—è–º–±–¥—ã **–º–æ–∂–Ω–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –≤ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –°++**: 
auto MyLambda = [](){};, –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ MyLambda –∏–º–µ–µ—Ç —Ç–∏–ø –ª—è–º–±–¥–∞, –¥–ª—è –≤—ã–∑–æ–≤–∞ —Å–∞–º–æ–π –ª—è–º–±–¥—ã  –Ω–∞–¥–æ –ø–∏—Å–∞—Ç—å MyLambda(); —Ç.–µ. –∫–∞–∫ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏.

</aside>

```cpp
int a = 5;
int b = 10;
auto sumLambda = [=](){return a + b;}
cout << sumLambda(); // 15
```

–ï—â—ë –ª—è–º–±–¥—ã –º–æ–∂–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Ç —Ç–∞–∫‚Ä¶

```cpp
auto lambda = [lifetime = shared_from_this(),
               handler  = std::move(handler),
               /*...*/]{}
```

## –¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è

- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º** –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä –≤—ã–∑–æ–≤–∞ ()
    
    ```cpp
    template<typename AnyFd>
    struct CloseSth 
    {
    	void operator()(AnyFd fd) 
    	{
    		fd.close();
    	}
    }
    ```
    
- **–ü—Ä–µ–¥–∏–∫–∞—Ç–æ–º** –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ä–∞–±–æ—Ç—ã –∫–æ—Ç–æ—Ä–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è boolean —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    
    ```cpp
    // –¢–∞–∫–∞—è –ª—è–º–±–¥–∞ –≤ –º–µ—Ç–æ–¥–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ - –ø—Ä–µ–¥–∏–∫–∞—Ç
    list.sort(..., []->bool(int first, int second){
    	return first > second;
    }
    ```
    
- **–ó–∞–º—ã–∫–∞–Ω–∏–µ–º** –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, —Å—Å—ã–ª–∞—é—â–∞—è—Å—è –≤ —Å–≤–æ—ë–º —Ç–µ–ª–µ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ—Å—è –≤ –æ–±–ª–∞—Å—Ç–∏ –∑–∞—Ö–≤–∞—Ç–∞
    
    ```cpp
    // a –∏ b - –≤—Ö–æ–¥–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –æ–Ω–∏ –Ω–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è, lambda - –∑–∞–º—ã–∫–∞–Ω–∏–µ
    auto lambda = [this](int a, int b){
    	return a + b;
    }
    ```
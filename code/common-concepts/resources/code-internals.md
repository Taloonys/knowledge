# –ö–æ–¥ –∏ –ø–∞–º—è—Ç—å
> –ó–∞–¥–∞—á–µ–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è *–∫–∞–∫ –¥–æ–ª–≥–æ –±—É–¥–µ—Ç –∂–∏—Ç—å –æ–±—ä–µ–∫—Ç* –∏/–∏–ª–∏ *–∫—É–¥–∞ –µ–≥–æ –ø–æ–º–µ—â–∞—Ç—å* –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è *–∞–ª–ª–æ–∫–∞—Ç–æ—Ä*. –û–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞. 
## –û–±–ª–∞—Å—Ç–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏
–ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±–æ—Ä–∫–∞, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø–æ–¥ —Ç–∞–∫–∏–µ —Å–µ–≥–º–µ–Ω—Ç—ã –¥–∞–Ω–Ω—ã—Ö —Ç–∞–∫–∏–µ –∫–∞–∫:

- *.bss* ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ 0
- *.CSTACK* ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç **—Å—Ç–µ–∫** –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π. **–°—Ç–µ–∫** —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É LIFO (Last in First out, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ª–æ–∂–∏–ª–∏, —Ç–æ –∏ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–≤—ã–º –¥–æ—Å—Ç–∞—Ç—å), –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å–æ —Å—Ç–µ–∫–æ–º –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –µ–≥–æ –Ω–∞—á–∞–ª–æ. –î–ª—è –ø–∫ –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ –ø–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—É –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∑–∞–¥–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É ‚Äú—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫-—Ç–æ —Å —Ç–∞–∫–æ–π-—Ç–æ –æ–±–ª–∞—Å—Ç—å—é –ø–∞–º—è—Ç–∏‚Äù —á–µ—Ä–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä—ã –≤ —Å–≤–æ—ë–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–µ.
- *.data* ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- *.data_init* ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –≤ .data —Å–µ–∫—Ü–∏–∏, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ª–∏–Ω–∫–µ—Ä–∞
- *HEAP* ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç **–∫—É—á—É**, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –ö—É—á–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ, –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –∫—É—á–µ, –∑–∞–¥–∞—ë—Ç—Å—è —Ä–∞–∑–º–µ—Ä –∏–∑—ã–º–∞–µ–º–æ–π –ø–∞–º—è—Ç–∏, –∏ –ø–∞–º—è—Ç—å —Ç–∞–∫–æ–≥–æ-—Ç–æ —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –≤ –Ω–µ–π –æ–±—ä–µ–∫—Ç–∞‚Ä¶ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –æ–±—Ä–∞–∑—É–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–∞ —Ç–æ–≥–æ, —á—Ç–æ –∏–∑—ã–º–∞–µ–º—É—é –∏–∑ –∫—É—á–∏ –ø–∞–º—è—Ç—å –Ω–∞–¥–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å.
- *.intvec* ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–±–ª–∏—Ü—É –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
- *.rodata* ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- *.text*  ‚Äî –°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã

![Untitled](resources/image-storage/Untitled%201.png)

üí° –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç–∞–∫, –∏–±–æ —ç—Ç–∏–º –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π **–∞–ª–ª–æ–∫–∞—Ç–æ—Ä**, –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ—à–∞–µ—Ç –Ω–∞–ø–∏—Å–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–∞ —Å—Ç–µ–∫–µ –¥–∞–∂–µ –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –≤ –Ø–ü **new**.

## Storage duration

üí° –ü—Ä–∏–º–µ—Ä –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –ø–ª—é—Å–æ–≤, –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ö–æ–∂–∞—è –ª–æ–≥–∏–∫–∞ –º–Ω–æ–≥–æ –≥–¥–µ
[Storage class specifiers - cppreference.com](https://en.cppreference.com/w/cpp/language/storage_duration)


> –ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –Ø–ü –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–Ω—è—Ç–∏–µ storage duration - –∞-–ª—è ‚Äú–∫–∞–∫ –¥–æ–ª–≥–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–±—ä–µ–∫—Ç‚Ä¶

–ï—Å—Ç—å –µ—â—ë —Ç–∞–∫–æ–µ –ø–æ–Ω—è—Ç–∏–µ –∫–∞–∫ lifetime‚Ä¶ **Lifetime** - —ç—Ç–æ —Ç–æ, –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –∂–∏–≤–æ–π –∏ –¥–æ—Å—Ç—É–ø–µ–Ω (–ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ delete –∏–ª–∏ –ø–æ –≤–∏—Å—è—â–µ–π —Å—Å—ã–ª–∫–µ –æ–±—ä–µ–∫—Ç –∫–∞–∫ –±—ã –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω, –Ω–æ –≤–æ—Ç —Å—Ç–æ–∏—Ç –ª–∏ —Ç–∞–∫ –¥–µ–ª–∞—Ç—å).

**storage duration** - –±–æ–ª—å—à–µ –ø—Ä–æ —Ç–æ, –∫–∞–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –µ–≥–æ - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ —Å—Ç–µ–∫–µ, –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º –º–µ—Å—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ç–æ–∫–∞, –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –±—É–¥–µ—Ç –≤ —Ö–∏–ø–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å-—É–¥–∞–ª—è—Ç—å.

–ò—Ö 3: 

- static storage duration (—Å—Ç–∞—Ç–∏–∫ –æ–±—ä–µ–∫—Ç—ã),
- automatic storage duration (–æ–±—ã—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –Ω–∞ —è–∫–æ–±—ã —Å—Ç—ç–∫–µ)
- dynamic storage duration (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã —Å new, –Ω–∞–ø—Ä–∏–º–µ—Ä)
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) thread storage duration - —Ö—Ä–∞–Ω–∏—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –ø–æ—Ç–æ–∫–∞ –æ–±—ä–µ–∫—Ç—ã

–û—Ç—Å—é–¥–∞ –∏ —Å–≤—è–∑–∏ —Ç–æ–≥–æ, –∫–æ–≥–¥–∞ –∫ —á–µ–º—É –∫—Ç–æ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –≤ –û–°.

## Stack allocation vs Dynamic allocation

*–ü–æ—á–µ–º—É —Å—Ç—ç–∫ –±—ã—Å—Ç—Ä–µ–µ –∫—É—á–∏?*

### –ê–ª–ª–æ–∫–∞—Ü–∏—è –Ω–∞ —Å—Ç—ç–∫–µ

> (–≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è)
- –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä
- —É–∫–∞–∑–∞—Ç–µ–ª—å —Å—Ç–µ–∫–∞ —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è –Ω–∞ –µ–≥–æ –∫–æ–Ω–µ—Ü

### –ê–ª–ª–æ–∫–∞—Ü–∏—è –Ω–∞ –∫—É—á–µ

> (–≥—Ä—É–±–æ –≥–æ–≤–æ—Ä—è)

–ê–ª–ª–æ–∫–∞—Ç–æ—Ä–æ–º –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –Ω–∞ –∫—É—á–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –ø—Ä–æ—Å–ª–æ–π–∫–∏ - **—á–∞–Ω–∫–∏**. –ß–∞–Ω–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —É—á–∞—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏, –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç—å—é (–æ–±—ã—á–Ω–æ —Ç–æ–π –∂–µ heap —Å–∞–º–æ–π OS). –ê–ª–ª–æ–∫–∞—Ç–æ—Ä—É –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å: —Å–∫–æ–ª—å–∫–æ –ø–∞–º—è—Ç–∏ –Ω—É–∂–Ω–æ –¥–ª—è –∑–∞–Ω—è—Ç–∏—è —á–∞–Ω–∫–∞ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö, –∫–∞–∫–∏–µ —á–∞–Ω–∫–∏ –∑–∞–Ω—è—Ç—ã, –Ω—É–∂–Ω–æ –ª–∏ –µ—â—ë –¥–æ–±–∞–≤–ª—è—Ç—å –∫–∞–∫–∏–µ-—Ç–æ —á–∞–Ω–∫–∏.. ‚Üí –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º –∏–ª–∏ –¥–∞–∂–µ —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —á–∞–Ω–∫–∞–º–∏. –ù—É –∏ –≤ –∫–æ–Ω—Ü–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ—Ç —Å–∞–º—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —É—á–∞—Å—Ç–æ–∫ –ø–∞–º—è—Ç–∏.

<aside>
üí° –î–ª—è **Windows —Ä–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - **1 –ú–ë**.
–î–ª—è **Linux —Ä–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - **4 –ú–ë**, –∫–æ—Ç–æ—Ä—ã–µ —Å–ø–æ–∫–æ–π–Ω–æ —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è –¥–æ 8 –ú–ë. (–¢.–µ. –Ω–∞ 4 –ú–ë —Å—Ç—ç–∫ –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–∏—Ç—Å—è, –∞ –ø–æ–¥–≥—Ä—É–∑–∏—Ç –µ—â—ë –æ–¥–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–∞–º—è—Ç–∏, –æ–¥–Ω–∞–∫–æ –Ω–∞ **8 –ú–ë** –≤ —Å—Ç—ç–∫–µ —É–∂–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ).

</aside>

## Function prologue and epilogue

[https://www.learnvulnerabilityresearch.com/stack-frame-function-prologue](https://www.learnvulnerabilityresearch.com/stack-frame-function-prologue)

> –ü—Ä–æ–ª–æ–≥ —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ –∞–¥—Ä–µ—Å–∞ –≤—ã–∑–æ–≤–∞ –ø—Ä–æ—à–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. 
> –í —ç–ø–∏–ª–æ–≥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–º–µ—â–µ–Ω–∏–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –ø–æ—Ç–æ–º —É–∫–∞–∑–∞—Ç–µ–ª—é –Ω–∞ —Å—Ç–µ–∫ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ (—Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å, –±–æ–ª—å—à–µ –µ—ë –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω—É–∂–Ω—ã, –æ–Ω–∏ –≤—ã–Ω–æ—Å—è—Ç—Å—è —Å–æ —Å—Ç–µ–∫–∞, —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –∫–æ–Ω–µ—Ü —Å—Ç–µ–∫–∞ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ, –≥–¥–µ –±—ã–ª, –¥–æ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏), –º–æ–∂–µ—Ç –ø–æ–º–µ—Å—Ç–∏—Ç—å—Å—è –Ω–∞ —Å—Ç–µ–∫ –≤—ã–∑–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ç.–ø.

–ü—Ä–∏–º–µ—Ä –ü—Ä–æ–ª–æ–≥–∞ —Ñ—É–Ω–∫—Ü–∏–∏: –≤ `rbp` –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤—ã–∑–æ–≤ –ø—Ä–æ—à–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞ `edi` –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `a` (`–∫–æ–¥ —Å–∏–º–≤–æ–ª–∞ 97`) –∏ `i` ( `—Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–∞—è 5` ).

![image.png](resources/image-storage/image.png)

![image.png](resources/image-storage/image%201.png)
